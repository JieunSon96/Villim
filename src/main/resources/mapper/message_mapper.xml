<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="Message">
	<select id="countReview" resultType="int">
		select count(g_review_public) from GUEST_REVIEW where home_seq=#{home_seq}
	</select>

	<insert id="messageInsert">
		insert into message
		values(message_seq.nextval,#{message_room_seq},#{home_seq},#{fromID},#{toID},#{message_content},to_char(SYSDATE,'YYYY"년"
		MM"월" DD"일"'),0)
	</insert>

	<select id="getHomeInfo" resultType="Home">
		select * from home where home_seq=#{home_seq}
	</select>
	
	<select id="messageRoomSeqExist" resultType="MessageRoom">
	select message_room_seq from message_room where host_email=#{host_email} and guest_email=#{guest_email} and home_seq=#{home_seq}
	</select>
	
	
	<select id="getRoomSeq" resultType="int">
	select message_room_seq.nextval from dual
	</select>
	
	<insert id="messageRoomInsert">
	insert into message_room values(#{message_room_seq},#{home_seq},#{host_email},#{guest_email},#{checkIn},#{checkOut},#{totalNumber})
	</insert>
</mapper>
